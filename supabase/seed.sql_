-- PYX Scanner: Seed Data
-- Populates all UI states for the landing page

-- Clean existing data (order matters due to FK constraints)
DELETE FROM scan_results;
DELETE FROM scan_jobs;
DELETE FROM skills;

-- ============================================================================
-- Skills
-- ============================================================================

-- 1. Verified (featured) — full data for "complete" UI record
INSERT INTO skills (id, owner, name, repo, description, repository_url, status, latest_scan_commit, last_safe_commit, last_safe_version, created_at, updated_at)
VALUES (
  '11111111-1111-1111-1111-111111111111',
  'anthropics', 'claude-memory',
  'anthropics/claude-memory',
  'Persistent memory management for Claude Code sessions with automatic context retrieval and indexing.',
  'https://github.com/anthropics/claude-memory',
  'verified', 'abc1234def5678', 'abc1234def5678', '2.1.0',
  now() - interval '30 days', now() - interval '2 hours'
);

-- 2. Verified
INSERT INTO skills (id, owner, name, repo, description, repository_url, status, latest_scan_commit, last_safe_commit, last_safe_version, created_at, updated_at)
VALUES (
  '22222222-2222-2222-2222-222222222222',
  'toolhouse', 'web-search',
  'toolhouse/web-search',
  'Real-time web search for AI agents with result ranking and filtering.',
  'https://github.com/toolhouse/web-search',
  'verified', 'ff00aa11bb22', 'ff00aa11bb22', '1.4.2',
  now() - interval '20 days', now() - interval '5 hours'
);

-- 3. Verified
INSERT INTO skills (id, owner, name, repo, description, repository_url, status, latest_scan_commit, last_safe_commit, last_safe_version, created_at, updated_at)
VALUES (
  '33333333-3333-3333-3333-333333333333',
  'devtools', 'git-hooks',
  'devtools/git-hooks',
  'Pre-commit hook management for automated code quality checks.',
  'https://github.com/devtools/git-hooks',
  'verified', 'cc44dd55ee66', 'cc44dd55ee66', '3.0.1',
  now() - interval '15 days', now() - interval '8 hours'
);

-- 4. Outdated
INSERT INTO skills (id, owner, name, repo, description, repository_url, status, latest_scan_commit, last_safe_commit, last_safe_version, created_at, updated_at)
VALUES (
  '44444444-4444-4444-4444-444444444444',
  'community', 'markdown-tools',
  'community/markdown-tools',
  'Markdown processing utilities for documentation generation.',
  'https://github.com/community/markdown-tools',
  'outdated', 'aa00bb11cc22', 'aa00bb11cc22', '1.2.0',
  now() - interval '60 days', now() - interval '14 days'
);

-- 5. Scanning (no scan result yet)
INSERT INTO skills (id, owner, name, repo, description, repository_url, status, created_at, updated_at)
VALUES (
  '55555555-5555-5555-5555-555555555555',
  'ai-labs', 'prompt-engine',
  'ai-labs/prompt-engine',
  'Dynamic prompt construction and template management.',
  'https://github.com/ai-labs/prompt-engine',
  'scanning',
  now() - interval '1 hour', now() - interval '5 minutes'
);

-- 6. Failed
INSERT INTO skills (id, owner, name, repo, description, repository_url, status, latest_scan_commit, created_at, updated_at)
VALUES (
  '66666666-6666-6666-6666-666666666666',
  'sketchy', 'data-helper',
  'sketchy/data-helper',
  'Data processing helper with external sync capabilities.',
  'https://github.com/sketchy/data-helper',
  'failed', 'dead0001beef',
  now() - interval '10 days', now() - interval '1 day'
);

-- 7. Failed
INSERT INTO skills (id, owner, name, repo, description, repository_url, status, latest_scan_commit, created_at, updated_at)
VALUES (
  '77777777-7777-7777-7777-777777777777',
  'unknown', 'free-tokens',
  'unknown/free-tokens',
  'Token generation and management utility.',
  'https://github.com/unknown/free-tokens',
  'failed', 'dead0002beef',
  now() - interval '8 days', now() - interval '2 days'
);

-- 8. Failed
INSERT INTO skills (id, owner, name, repo, description, repository_url, status, latest_scan_commit, created_at, updated_at)
VALUES (
  '88888888-8888-8888-8888-888888888888',
  'crypto', 'wallet-sync',
  'crypto/wallet-sync',
  'Cryptocurrency wallet synchronization tool.',
  'https://github.com/crypto/wallet-sync',
  'failed', 'dead0003beef',
  now() - interval '5 days', now() - interval '3 days'
);

-- 9. Multi-skill repo example: two skills from the same repo
INSERT INTO skills (id, owner, name, repo, description, repository_url, status, latest_scan_commit, last_safe_commit, last_safe_version, created_at, updated_at)
VALUES (
  '99999999-9999-9999-9999-999999999991',
  'mcptools', 'file-reader',
  'mcptools/fs-toolkit',
  'Read files from the local filesystem with path validation.',
  'https://github.com/mcptools/fs-toolkit',
  'verified', 'aabb0011cc22', 'aabb0011cc22', '1.0.0',
  now() - interval '12 days', now() - interval '6 hours'
);

INSERT INTO skills (id, owner, name, repo, description, repository_url, status, latest_scan_commit, last_safe_commit, last_safe_version, created_at, updated_at)
VALUES (
  '99999999-9999-9999-9999-999999999992',
  'mcptools', 'file-writer',
  'mcptools/fs-toolkit',
  'Write and append to files with directory creation support.',
  'https://github.com/mcptools/fs-toolkit',
  'verified', 'aabb0011cc22', 'aabb0011cc22', '1.0.0',
  now() - interval '12 days', now() - interval '6 hours'
);

-- ============================================================================
-- Scan Results
-- ============================================================================

-- Verified skills: low risk_score (0-2 = safe)
INSERT INTO scan_results (skill_id, commit_hash, version, trust_status, recommendation, risk_score, summary, details, scanned_at)
VALUES (
  '11111111-1111-1111-1111-111111111111',
  'abc1234def5678', '2.1.0', 'verified', 'safe', 0.2,
  'No security issues detected. All file operations scoped to designated memory directory. No network access outside approved endpoints.',
  '{"categories": ["file_access", "network"], "permissions_reviewed": true}'::jsonb,
  now() - interval '2 hours'
);

INSERT INTO scan_results (skill_id, commit_hash, version, trust_status, recommendation, risk_score, summary, details, scanned_at)
VALUES (
  '22222222-2222-2222-2222-222222222222',
  'ff00aa11bb22', '1.4.2', 'verified', 'safe', 0.5,
  'Clean scan. Network requests limited to documented search APIs. No credential access.',
  '{"categories": ["network"], "permissions_reviewed": true}'::jsonb,
  now() - interval '5 hours'
);

INSERT INTO scan_results (skill_id, commit_hash, version, trust_status, recommendation, risk_score, summary, details, scanned_at)
VALUES (
  '33333333-3333-3333-3333-333333333333',
  'cc44dd55ee66', '3.0.1', 'verified', 'safe', 0.3,
  'Git hook operations verified safe. No arbitrary command execution. Scoped to repository directory.',
  '{"categories": ["file_access", "process"], "permissions_reviewed": true}'::jsonb,
  now() - interval '8 hours'
);

-- Outdated skill: was safe at time of scan
INSERT INTO scan_results (skill_id, commit_hash, version, trust_status, recommendation, risk_score, summary, details, scanned_at)
VALUES (
  '44444444-4444-4444-4444-444444444444',
  'aa00bb11cc22', '1.2.0', 'verified', 'caution', 0.9,
  'No issues at time of scan, but version is outdated. Recommend re-scanning latest version.',
  '{"categories": ["file_access"], "permissions_reviewed": true}'::jsonb,
  now() - interval '14 days'
);

-- Failed skills: high risk_score (7-10 = dangerous)
INSERT INTO scan_results (skill_id, commit_hash, trust_status, recommendation, risk_score, summary, details, scanned_at)
VALUES (
  '66666666-6666-6666-6666-666666666666',
  'dead0001beef', 'failed', 'danger', 8.8,
  'Data exfiltration to external endpoint detected. Sends local file contents to unauthorized remote server.',
  '{"tag": "Data Exfil", "categories": ["network", "file_access"], "threat_type": "exfiltration"}'::jsonb,
  now() - interval '1 day'
);

INSERT INTO scan_results (skill_id, commit_hash, trust_status, recommendation, risk_score, summary, details, scanned_at)
VALUES (
  '77777777-7777-7777-7777-777777777777',
  'dead0002beef', 'failed', 'danger', 9.2,
  'Prompt injection — credential theft. Injects hidden instructions to extract API keys and tokens from user context.',
  '{"tag": "Prompt Inject", "categories": ["prompt_injection", "credential_access"], "threat_type": "injection"}'::jsonb,
  now() - interval '2 days'
);

INSERT INTO scan_results (skill_id, commit_hash, trust_status, recommendation, risk_score, summary, details, scanned_at)
VALUES (
  '88888888-8888-8888-8888-888888888888',
  'dead0003beef', 'failed', 'danger', 9.7,
  'Obfuscated commands targeting ~/.ssh directory. Attempts to read and exfiltrate SSH private keys.',
  '{"tag": "Secret Access", "categories": ["file_access", "credential_access"], "threat_type": "secret_theft"}'::jsonb,
  now() - interval '3 days'
);

-- Multi-skill repo scan results
INSERT INTO scan_results (skill_id, commit_hash, version, trust_status, recommendation, risk_score, summary, details, scanned_at)
VALUES (
  '99999999-9999-9999-9999-999999999991',
  'aabb0011cc22', '1.0.0', 'verified', 'safe', 0.4,
  'File reading scoped to allowed directories. No exfiltration detected.',
  '{"categories": ["file_access"], "permissions_reviewed": true}'::jsonb,
  now() - interval '6 hours'
);

INSERT INTO scan_results (skill_id, commit_hash, version, trust_status, recommendation, risk_score, summary, details, scanned_at)
VALUES (
  '99999999-9999-9999-9999-999999999992',
  'aabb0011cc22', '1.0.0', 'verified', 'safe', 1.2,
  'File writing with directory creation. Operations scoped to working directory. No overwrite of system files.',
  '{"categories": ["file_access"], "permissions_reviewed": true}'::jsonb,
  now() - interval '6 hours'
);
